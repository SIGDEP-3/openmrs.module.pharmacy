<?xml version="1.1" encoding="UTF-8"?>

<!--<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"-->
<!--                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"-->
<!--                   xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"-->
<!--                   xmlns:pro="http://www.liquibase.org/xml/ns/pro"-->
<!--                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-->
<!--                   http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.3.xsd-->
<!--        http://www.liquibase.org/xml/ns/dbchangelog-ext-->
<!--        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd-->
<!--        http://www.liquibase.org/xml/ns/pro-->
<!--        http://www.liquibase.org/xml/ns/dbchangelog-->
<!--        http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.3.xsd">-->

<!--<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"-->
<!--                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"-->
<!--                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9-->
<!--                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">-->
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext
	    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
		http://www.liquibase.org/xml/ns/dbchangelog
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <!--
        See http://www.liquibase.org/manual/home#available_database_refactorings
        for a list of supported elements and attributes
    -->

    <changeSet id="pharmacy-product-unit" author="BOGUI SERGE">
        <createTable tableName="pharmacy_product_unit">
            <column name="product_unit_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="name" type="varchar(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="description" type="varchar(255)"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="pharmacy-product" author="BOGUI SERGE">
        <createTable tableName="pharmacy_product">
            <column name="product_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="code" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="retail_name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="wholesale_name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="product_retail_unit" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="product_wholesale_unit" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="unit_conversion" type="int">
                <constraints nullable="false"/>
            </column>

            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_product_unit_retail"
                                 baseTableName="pharmacy_product" baseColumnNames="product_retail_unit"
                                 referencedTableName="pharmacy_product_unit" referencedColumnNames="product_unit_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_product_unit_wholesale"
                                 baseTableName="pharmacy_product" baseColumnNames="product_wholesale_unit"
                                 referencedTableName="pharmacy_product_unit" referencedColumnNames="product_unit_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-program" author="BOGUI SERGE">
        <createTable tableName="pharmacy_product_program">
            <column name="product_program_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="description" type="varchar(255)"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="pharmacy-product-program-members" author="BOGUI SERGE">
        <createTable tableName="pharmacy_product_program_members">
            <column name="program_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="product_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_product_program_members_program"
                                 baseTableName="pharmacy_product_program_members" baseColumnNames="program_id"
                                 referencedTableName="pharmacy_product_program" referencedColumnNames="product_program_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_product_product_program_members_product"
                                 baseTableName="pharmacy_product_program_members" baseColumnNames="product_id"
                                 referencedTableName="pharmacy_product" referencedColumnNames="product_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-price-1" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_price"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_price">
            <column name="product_price_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="product_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="product_program_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="sale_price" type="double">
                <constraints nullable="false"/>
            </column>
            <column name="purchase_price" type="double">
                <constraints nullable="false"/>
            </column>
            <column name="date_created" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="is_active" type="boolean" defaultValueBoolean="true">
                <constraints nullable="false"/>
            </column>

            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_price_product"
                                 baseTableName="pharmacy_product_price" baseColumnNames="product_id"
                                 referencedTableName="pharmacy_product" referencedColumnNames="product_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_price_program"
                                 baseTableName="pharmacy_product_price" baseColumnNames="product_program_id"
                                 referencedTableName="pharmacy_product_program" referencedColumnNames="product_program_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-regimen" author="BOGUI SERGE">
        <createTable tableName="pharmacy_product_regimen">
            <column name="product_regimen_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="concept_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_product_regimen_concept"
                                 baseTableName="pharmacy_product_regimen" baseColumnNames="concept_id"
                                 referencedTableName="concept" referencedColumnNames="concept_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-regimen-members" author="BOGUI SERGE">
        <createTable tableName="pharmacy_product_regimen_members">
            <column name="regimen_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="product_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_product_regimen_members_regimen"
                                 baseTableName="pharmacy_product_regimen_members" baseColumnNames="regimen_id"
                                 referencedTableName="pharmacy_product_regimen" referencedColumnNames="product_regimen_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_product_product_regimen_members_product"
                                 baseTableName="pharmacy_product_regimen_members" baseColumnNames="product_id"
                                 referencedTableName="pharmacy_product" referencedColumnNames="product_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-supplier" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_supplier"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_supplier">
            <column name="product_supplier_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="name" type="varchar(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="short_name" type="varchar(50)"/>
            <column name="phone_number" type="varchar(50)"/>
            <column name="description" type="varchar(255)"/>
            <column name="email" type="varchar(255)"/>
            <column name="location_id" type="int"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_supplier_location"
                                 baseTableName="pharmacy_product_supplier" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-attribute" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_attribute"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_attribute">
            <column name="product_attribute_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="product_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="batch_number" type="varchar(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="expiry_date" type="date"/>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>

            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_product"
                                 baseTableName="pharmacy_product_attribute" baseColumnNames="product_id"
                                 referencedTableName="pharmacy_product" referencedColumnNames="product_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_location"
                                 baseTableName="pharmacy_product_attribute" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-operation" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_operation"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_operation">
            <column name="product_operation_id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="operation_number" type="varchar(100)"/>
            <column name="program_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="operation_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="operation_status" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="incidence" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="observation" type="varchar(255)"/>

            <column name="creator" type="int" >
                <constraints nullable="false" />
            </column>
            <column name="date_created" type="datetime" >
                <constraints nullable="false"/>
            </column>
            <column name="changed_by" type="int" />
            <column name="date_changed" type="datetime" />
            <column name="voided" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="voided_by" type="int" />
            <column name="date_voided" type="datetime" />
            <column name="void_reason" type="varchar(255)" defaultValue="null"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_operation_program"
                                 baseTableName="pharmacy_product_operation" baseColumnNames="program_id"
                                 referencedTableName="pharmacy_product_program" referencedColumnNames="product_program_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_operation_creator"
                                 baseTableName="pharmacy_product_operation" baseColumnNames="creator"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_operation_changed_by"
                                 baseTableName="pharmacy_product_operation" baseColumnNames="changed_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_operation_voided_by"
                                 baseTableName="pharmacy_product_operation" baseColumnNames="voided_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_operation_location"
                                 baseTableName="pharmacy_product_operation" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-attribute-flux" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_attribute_flux"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_attribute_flux">
            <column name="product_attribute_flux_id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="product_attribute_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="operation_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="quantity" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="operation_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>

            <column name="creator" type="int" >
                <constraints nullable="false" />
            </column>
            <column name="date_created" type="datetime" >
                <constraints nullable="false"/>
            </column>
            <column name="changed_by" type="int" />
            <column name="date_changed" type="datetime" />
            <column name="voided" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="voided_by" type="int" />
            <column name="date_voided" type="datetime" />
            <column name="void_reason" type="varchar(255)" defaultValue="null"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_flux_product_attribute"
                                 baseTableName="pharmacy_product_attribute_flux" baseColumnNames="product_attribute_id"
                                 referencedTableName="pharmacy_product_attribute" referencedColumnNames="product_attribute_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_flux_product_operation"
                                 baseTableName="pharmacy_product_attribute_flux" baseColumnNames="operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_flux_creator"
                                 baseTableName="pharmacy_product_attribute_flux" baseColumnNames="creator"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_flux_changed_by"
                                 baseTableName="pharmacy_product_attribute_flux" baseColumnNames="changed_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_flux_voided_by"
                                 baseTableName="pharmacy_product_attribute_flux" baseColumnNames="voided_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_flux_location"
                                 baseTableName="pharmacy_product_attribute_flux" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-attribute-other-flux" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_attribute_other_flux"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_attribute_other_flux">
            <column name="product_attribute_other_flux_id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="product_attribute_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="operation_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="quantity" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_other_flux_product_attribute"
                                 baseTableName="pharmacy_product_attribute_other_flux" baseColumnNames="product_attribute_id"
                                 referencedTableName="pharmacy_product_attribute" referencedColumnNames="product_attribute_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_other_flux_product_operation"
                                 baseTableName="pharmacy_product_attribute_other_flux" baseColumnNames="operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_other_flux_location"
                                 baseTableName="pharmacy_product_attribute_other_flux" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-reception" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_reception"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_reception">
            <column name="product_operation_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="product_supplier_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="reception_mode" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_reception_product_operation"
                                 baseTableName="pharmacy_product_reception" baseColumnNames="product_operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_reception_product_supplier"
                                 baseTableName="pharmacy_product_reception" baseColumnNames="product_supplier_id"
                                 referencedTableName="pharmacy_product_supplier" referencedColumnNames="product_supplier_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-inventory" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_inventory"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_inventory">
            <column name="product_operation_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="inventory_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="inventory_start_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="inventory_end_date" type="date">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_inventory_product_operation"
                                 baseTableName="pharmacy_product_inventory" baseColumnNames="product_operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>

    </changeSet>

    <changeSet id="pharmacy-product-dispensing" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_dispensing"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_dispensing">
            <column name="product_operation_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="regimen_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="prescription_date" type="date">
                <constraints nullable="false"/>
            </column>
            <column name="treatment_days" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="patient_id" type="int"/>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_dispensing_product_operation"
                                 baseTableName="pharmacy_product_dispensing" baseColumnNames="product_operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_dispensing_product_regimen"
                                 baseTableName="pharmacy_product_dispensing" baseColumnNames="regimen_id"
                                 referencedTableName="pharmacy_product_regimen" referencedColumnNames="product_regimen_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_dispensing_patient"
                                 baseTableName="pharmacy_product_dispensing" baseColumnNames="patient_id"
                                 referencedTableName="patient" referencedColumnNames="patient_id"/>
    </changeSet>

    <changeSet id="pharmacy-mobile-patient" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_mobile_patient"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_mobile_patient">
            <column name="mobile_patient_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="age" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="identifier" type="varchar(100)"/>
            <column name="gender" type="varchar(5)"/>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_location"
                                 baseTableName="pharmacy_mobile_patient" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-mobile-patient-product-dispensing-members" author="BOGUI SERGE">
        <createTable tableName="pharmacy_mobile_patient_product_dispensing_members">
            <column name="product_dispensing_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="mobile_patient_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_product_dispensing_members_dispensing"
                                 baseTableName="pharmacy_mobile_patient_product_dispensing_members"
                                 baseColumnNames="product_dispensing_id"
                                 referencedTableName="pharmacy_product_dispensing" referencedColumnNames="product_operation_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_product_dispensing_mobile_patient"
                                 baseTableName="pharmacy_mobile_patient_product_dispensing_members"
                                 baseColumnNames="mobile_patient_id"
                                 referencedTableName="pharmacy_mobile_patient" referencedColumnNames="mobile_patient_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-exchange-entity" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_exchange_entity"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_exchange_entity">
            <column name="product_exchange_entity_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="name" type="varchar(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="description" type="varchar(255)"/>
            <column name="location_id" type="int"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_exchange_entity_location"
                                 baseTableName="pharmacy_product_exchange_entity" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-movement-entry" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_movement_entry"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_movement_entry">
            <column name="product_operation_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="sender" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="stock_entry_type" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_movement_entry_operation"
                                 baseTableName="pharmacy_product_movement_entry" baseColumnNames="product_operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_movement_entry_sender"
                                 baseTableName="pharmacy_product_movement_entry" baseColumnNames="sender"
                                 referencedTableName="pharmacy_product_exchange_entity" referencedColumnNames="product_exchange_entity_id"/>

    </changeSet>

    <changeSet id="pharmacy-product-movement-out" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_movement_out"/>
            </not>
        </preConditions>

        <createTable tableName="pharmacy_product_movement_out">
            <column name="product_operation_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="recipient" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="stock_out_type" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_movement_out_operation"
                                 baseTableName="pharmacy_product_movement_out" baseColumnNames="product_operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_movement_out_recipient"
                                 baseTableName="pharmacy_product_movement_out" baseColumnNames="recipient"
                                 referencedTableName="pharmacy_product_exchange_entity" referencedColumnNames="product_exchange_entity_id"/>

    </changeSet>

    <changeSet id="pharmacy-product-attribute-stock" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_attribute_stock"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_attribute_stock">
            <column name="product_attribute_stock_id" type="int" autoIncrement="true">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="product_attribute_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="quantity_in_stock" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="date_created" type="date"/>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>

            <column name="uuid" type="varchar(38)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_stock_product_attribute"
                                 baseTableName="pharmacy_product_attribute_stock" baseColumnNames="product_attribute_id"
                                 referencedTableName="pharmacy_product_attribute" referencedColumnNames="product_attribute_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_stock_location"
                                 baseTableName="pharmacy_product_attribute_stock" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>
    <changeSet id="add-encounter-type-dispensing-new" author="BOGUI SERGE">
        <preConditions onFail="CONTINUE">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM encounter_type WHERE name = 'DISPENSATION'</sqlCheck>
        </preConditions>
        <insert tableName="encounter_type">
            <column name="name" value="DISPENSATION"/>
<!--            <column name="description" value=""/>-->
            <column name="creator" type="int">1</column>
            <column name="date_created" type="datetime" value="2020-11-10"/>
            <column name="retired" type="boolean">false</column>
            <column name="uuid" value="cfb217pd-4af2-40f4-9d6e-0d1b38d2af86"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO encounter_type (name, description, creator, date_created, retired, uuid)-->
<!--            VALUE ('DISPENSATION', NULL, 1, '2020-11-10', 0, 'cfb217pd-4af2-40f4-9d6e-0d1b38d2af86');-->
<!--        </sql>-->
    </changeSet>

    <changeSet id="insert-pharmacy-program-data-plus-1" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM pharmacy_product_program</sqlCheck>
        </preConditions>
<!--        <insert tableName="pharmacy_product_program">-->
<!--            <column name="name">PNLSARVIO</column>-->
<!--            <column name="uuid">44ac1b52-2691-11eb-ae9e-0242ac1a0002</column>-->
<!--        </insert>-->
<!--        <insert tableName="pharmacy_product_program">-->
<!--            <column name="name">PNLSLAB</column>-->
<!--            <column name="uuid">44ac98f8-2691-11eb-ae9e-0242ac1a0002</column>-->
<!--        </insert>-->
<!--        <insert tableName="pharmacy_product_program">-->
<!--            <column name="name">ME_REC</column>-->
<!--            <column name="uuid">44ac9d75-2691-11eb-ae9e-0242ac1a0002</column>-->
<!--        </insert>-->
        <sql>
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (1, 'PNLSARVIO', null, '44ac1b52-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (2, 'PNLSLAB', null, '44ac98f8-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (3, 'ME_REC', null, '44ac9d75-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (4, 'GTC', null, '44ac9e02-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (5, 'PNSME', null, '44ac9e6c-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (6, 'PNLT', null, '44ac9ecd-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (7, 'PNLP', null, '44ac9f24-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (8, 'CONSO', null, '44ac9f79-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (9, 'PNLSTRC', null, '44aca368-2691-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (10, 'ME_CMU', null, 'f9a396d2-17f5-44ff-9cd0-91ac06501fab');
            INSERT INTO pharmacy_product_program (product_program_id, name, description, uuid) VALUES (11, 'PNLS_CHARGE VIRALE', null, '572d790a-1da2-4a9a-b1a4-d483cfae2856');
        </sql>
    </changeSet>

    <changeSet id="insert-pharmacy-unit-data-plus-1" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM pharmacy_product_unit</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (1, 'AIGUILLE', null, '5764bf2b-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (2, 'AMPOULE', null, '5763fc7b-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (3, 'BALLE', null, '57655045-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (4, 'BANDE', null, '5764bea8-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (5, 'BIDON', null, '57644fde-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (6, 'BOITE', null, '5763fd30-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (7, 'CAPSULE', null, '57640088-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (8, 'CARTON', null, '57655c3e-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (9, 'CASSET', null, '57656917-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (10, 'CASSETTE', null, '5764a441-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (11, 'COMPRIME', null, '5763fcb3-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (12, 'CORPS', null, '5764bf5f-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (13, 'CRYOTUBE', null, '5764b1f5-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (14, 'CUPS', null, '5764b13d-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (15, 'CUPULE', null, '5764a080-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (16, 'CUVETTE', null, '5764a427-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (17, 'EMBOUT', null, '5764b1c0-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (18, 'FIL', null, '5764509c-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (19, 'FL', null, '57640edc-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (20, 'FLACON', null, '5763fc2e-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (21, 'GELULE', null, '5764040f-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (22, 'KIT', null, '5763fba9-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (23, 'LANCETTE', null, '5764bd30-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (24, 'MICROTUBE', null, '5764b624-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (25, 'OVULE', null, '57640bf5-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (26, 'PAIRE', null, '5764581e-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (27, 'PAQUET', null, '57644366-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (28, 'PASTILLE', null, '5764c02e-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (29, 'PIECE', null, '5764b6d8-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (30, 'PLAQUETTE', null, '576487ac-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (31, 'POCHE', null, '57643b53-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (32, 'POT', null, '576418e5-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (33, 'RACK', null, '5764bc7f-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (34, 'ROUL', null, '57650319-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (35, 'ROULEAU', null, '5764429a-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (36, 'SAC', null, '5764b6fc-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (37, 'SACHET', null, '5763fe70-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (38, 'SEGMENT', null, '5764a0de-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (39, 'SERINGUE', null, '576497cf-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (40, 'SUPPOSITOIRE', null, '57641f48-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (41, 'TEST', null, '57648bba-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (42, 'TUBE', null, '57645693-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (43, 'UNITE', null, '5763ff79-2693-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (44, 'BOITE/500', null, '725e4480-4381-400d-8dc9-f3a137574973');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (45, 'CP', null, '3614cfae-0b61-4054-bb14-012ea332c262');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (46, 'MICROPIPETTE', null, '55ec505d-259a-464b-a598-d980eae5eeeb');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (47, 'PAQUET/125', null, '40899a34-b523-4dc6-932c-9f57f84354d1');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (48, 'PAQUET/500', null, 'd8eb5457-c5a7-460d-9591-c941cfeee2d6');
            INSERT INTO pharmacy_product_unit (product_unit_id, name, description, uuid) VALUES (49, 'PIPETTE', null, '7ef8c46d-6a50-43c4-85f3-7cc76568c5f9');
        </sql>
    </changeSet>

    <changeSet id="insert-pharmacy-supplier-uuid" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM pharmacy_product_supplier</sqlCheck>
        </preConditions>
        <insert tableName="pharmacy_product_supplier">
            <column name="name" value="NOUVELLE PHARMACIE DE LA SANTE PUBLIQUE"/>
            <column name="short_name" value="NPSP"/>
            <column name="uuid" value="NPSPFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO pharmacy_product_supplier (name, short_name, phone_number, description, email, location_id, uuid)-->
<!--            VALUES ('NOUVELLE PHARMACIE DE LA SANTE PUBLIQUE', 'NPSP', NULL, NULL, NULL, NULL, 'NPSPFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF');-->
<!--        </sql>-->
    </changeSet>

    <changeSet id="pharmacy-add-column-observation-flux" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_product_attribute_flux" columnName="observation"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_product_attribute_flux">
            <column name="observation" type="varchar(255)"/>
        </addColumn>
    </changeSet>

    <changeSet id="pharmacy-drop-index-patient-dispensing" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyName="pharmacy_product_dispensing_patient"/>
        </preConditions>
        <dropForeignKeyConstraint baseTableName="pharmacy_product_dispensing" constraintName="pharmacy_product_dispensing_patient"/>
    </changeSet>

    <changeSet id="pharmacy-remove-patient-id-dispensing" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <columnExists tableName="pharmacy_product_dispensing" columnName="patient_id"/>
        </preConditions>
        <dropColumn tableName="pharmacy_product_dispensing" columnName="patient_id"/>
        <addColumn tableName="pharmacy_product_dispensing">
            <column name="encounter_id" type="int"/>
        </addColumn>
        <addForeignKeyConstraint constraintName="pharmacy_product_dispensing_encounter"
                                 baseTableName="pharmacy_product_dispensing" baseColumnNames="encounter_id"
                                 referencedTableName="encounter" referencedColumnNames="encounter_id"/>
    </changeSet>

<!--    <changeSet id="pharmacy-remove-foreign-key-other-flux" author="BOGUI SERGE">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <foreignKeyConstraintExists foreignKeyName="pharmacy_product_attribute_other_flux_product_attribute"/>-->
<!--        </preConditions>-->
<!--        <dropForeignKeyConstraint baseTableName="pharmacy_product_attribute_other_flux" constraintName="pharmacy_product_attribute_other_flux_product_attribute"/>-->
<!--        <dropForeignKeyConstraint baseTableName="pharmacy_product_attribute_other_flux" constraintName="pharmacy_product_attribute_other_flux_product_operation"/>-->
<!--        <dropColumn tableName="pharmacy_product_attribute_other_flux" columnName="product_attribute_id"/>-->
<!--        <dropColumn tableName="pharmacy_product_attribute_other_flux" columnName="operation_id"/>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-add-column-attribute-flux-to-other-flux" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_product_attribute_other_flux" columnName="label"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_product_attribute_other_flux">
            <column name="label" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
        </addColumn>
<!--        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_other_flux_product_attribute_flux"-->
<!--                                 baseTableName="pharmacy_product_attribute_other_flux" baseColumnNames="product_attribute_flux_id"-->
<!--                                 referencedTableName="pharmacy_product_attribute_flux" referencedColumnNames="product_attribute_flux_id"/>-->
    </changeSet>

<!--    <changeSet id="change-pharmacy-price-column-date-created" author="BOGUI SERGE">-->
<!--        <modifyDataType tableName="pharmacy_product_price" columnName="date_created" newDataType="datetime"/>-->
<!--        <modifyDataType tableName="pharmacy_product_price" columnName="sale_price" newDataType="double"/>-->

<!--&lt;!&ndash;        <modifyColumn tableName="pharmacy_product_price">&ndash;&gt;-->
<!--&lt;!&ndash;            <column name="date_created" type="datetime">&ndash;&gt;-->
<!--&lt;!&ndash;                <constraints nullable="false"/>&ndash;&gt;-->
<!--&lt;!&ndash;            </column>&ndash;&gt;-->
<!--&lt;!&ndash;        </modifyColumn>&ndash;&gt;-->
<!--&lt;!&ndash;        <modifyColumn tableName="pharmacy_product_price">&ndash;&gt;-->
<!--&lt;!&ndash;            <column name="sale_price" type="double">&ndash;&gt;-->
<!--&lt;!&ndash;                <constraints nullable="false"/>&ndash;&gt;-->
<!--&lt;!&ndash;            </column>&ndash;&gt;-->
<!--&lt;!&ndash;        </modifyColumn>&ndash;&gt;-->
<!--    </changeSet>-->

<!--    <changeSet id="pharmacy-remove-constraint-sale-price-price" author="BOGUI SERGE">-->
<!--        <dropUniqueConstraint tableName="pharmacy_product_price"-->
<!--                              constraintName="sale_price"/>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-inventory-drop-end-inventory-date" author="BOGUI SERGE">
        <dropColumn tableName="pharmacy_product_inventory" columnName="inventory_date"/>
        <dropColumn tableName="pharmacy_product_inventory" columnName="inventory_end_date"/>
    </changeSet>

    <changeSet id="pharmacy-inventory-add-column-inventory-type" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_product_inventory" columnName="inventory_type"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_product_inventory">
            <column name="inventory_type" type="int">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="pharmacy-drop-index-regimen-dispensing" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyName="pharmacy_product_dispensing_product_regimen"/>
        </preConditions>
        <dropForeignKeyConstraint baseTableName="pharmacy_product_dispensing" constraintName="pharmacy_product_dispensing_product_regimen"/>
    </changeSet>

    <changeSet id="pharmacy-edit-dispensing-to-dispensation" author="BOGUI SERGE">
        <dropColumn tableName="pharmacy_product_dispensing" columnName="regimen_id"/>
        <dropColumn tableName="pharmacy_product_dispensing" columnName="treatment_days"/>
        <renameTable oldTableName="pharmacy_product_dispensing" newTableName="pharmacy_product_dispensation"/>
    </changeSet>

    <changeSet id="pharmacy-remove-dispensation-members" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="pharmacy_mobile_patient_product_dispensation_members"/>
        </preConditions>
        <dropTable tableName="pharmacy_mobile_patient_product_dispensation_members"/>
    </changeSet>

    <changeSet id="pharmacy-mobile-patient-dispensation-info" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_mobile_patient_dispensation_info"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_mobile_patient_dispensation_info">
            <column name="mobile_dispensation_info_id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="regimen_id" type="int"/>
            <column name="mobile_patient_id" type="int"/>
            <column name="product_dispensation_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="goal" type="int"/>
            <column name="provider_id" type="int"/>
            <column name="location_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="creator" type="int" >
                <constraints nullable="false" />
            </column>
            <column name="date_created" type="datetime" >
                <constraints nullable="false"/>
            </column>
            <column name="changed_by" type="int" />
            <column name="date_changed" type="datetime" />
            <column name="voided" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="voided_by" type="int" />
            <column name="date_voided" type="datetime" />
            <column name="void_reason" type="varchar(255)" defaultValue="null"/>
            <column name="uuid" type="varchar(38)">
                <constraints nullable="false"/>
            </column>
        </createTable>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_regimen"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="regimen_id"
                                 referencedTableName="pharmacy_product_regimen" referencedColumnNames="product_regimen_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_dispensation"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="product_dispensation_id"
                                 referencedTableName="pharmacy_product_dispensation" referencedColumnNames="product_operation_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_mobile_patient"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="mobile_patient_id"
                                 referencedTableName="pharmacy_mobile_patient" referencedColumnNames="mobile_patient_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_provider"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="provider_id"
                                 referencedTableName="provider" referencedColumnNames="provider_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_creator"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="creator"
                                 referencedTableName="users" referencedColumnNames="user_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_changed_by"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="changed_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_voided_by"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="voided_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_location"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="pharmacy-add-treatment-days-dispensation-info" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_mobile_patient_dispensation_info" columnName="treatment_days"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_mobile_patient_dispensation_info">
            <column name="treatment_days" type="int">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

<!--    <changeSet id="pharmacy-add-goal_concept" author="BOGUI SERGE">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <not>-->
<!--                <sqlCheck expectedResult="165009">SELECT concept_id FROM concept WHERE concept_id = 165009</sqlCheck>-->
<!--            </not>-->
<!--        </preConditions>-->
<!--        <sql>-->
<!--            INSERT INTO concept (concept_id, retired, datatype_id, class_id, is_set, creator, date_created, uuid)-->
<!--            VALUES (165009, 0, 3, 7, 0, 1, '2020-11-27 00:00:00', '165009AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');-->

<!--            INSERT INTO concept_name (concept_id, name, date_created, concept_name_type, creator, locale, locale_preferred, voided, uuid)-->
<!--            VALUES (165009, 'Goal', '2020-11-27 00:00:00', 'FULLY_SPECIFIED', 1, 'fr', 1, 0, '165009AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');-->

<!--            INSERT INTO concept_word (concept_id, word, locale, concept_name_id, weight)-->
<!--            VALUES (concept_id, 'Goal', 'fr', (SELECT concept-name_id FROM concept_name WHERE concept_id = 165009), (PI() - 1.0));-->
<!--        </sql>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-add-patient-type-to-mobile-patient" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_mobile_patient" columnName="patient_type"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_mobile_patient">
            <column name="patient_type" type="int">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="pharmacy-add-column-treatment-end-date-mobile-ingo" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_mobile_patient_dispensation_info" columnName="treatment_end_date"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_mobile_patient_dispensation_info">
            <column name="treatment_end_date" type="date">
                <constraints nullable="false"/>
            </column>
        </addColumn>
    </changeSet>

    <changeSet id="pharmacy-add-product-to-attribute-other-flux" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_product_attribute_other_flux" columnName="product_id"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_product_attribute_other_flux">
            <column name="product_id" type="int"/>
        </addColumn>

        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_other_flux_product_id"
                                 baseTableName="pharmacy_product_attribute_other_flux" baseColumnNames="product_id"
                                 referencedTableName="pharmacy_product" referencedColumnNames="product_id"/>

        <dropNotNullConstraint tableName="pharmacy_product_attribute_other_flux" columnName="product_attribute_id" columnDataType="int"/>
    </changeSet>

    <changeSet id="pharmacy-dispensation-add-one-to-one-mobile-patient-info-2" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <columnExists columnName="product_dispensation_id" tableName="pharmacy_mobile_patient_dispensation_info"/>
        </preConditions>
        <dropForeignKeyConstraint baseTableName="pharmacy_mobile_patient_dispensation_info" constraintName="pharmacy_mobile_patient_dispensation_info_dispensation"/>
        <dropColumn tableName="pharmacy_mobile_patient_dispensation_info" columnName="product_dispensation_id" />
    </changeSet>

    <changeSet id="pharmacy-dispensation-add-one-to-one-mobile-patient-info-3" author="BOGUI SERGE">
        <modifyDataType tableName="pharmacy_mobile_patient_dispensation_info" columnName="mobile_dispensation_info_id" newDataType="int"/>

        <addForeignKeyConstraint constraintName="pharmacy_mobile_patient_dispensation_info_product_dispensation"
                                 baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="mobile_dispensation_info_id"
                                 referencedTableName="pharmacy_product_dispensation" referencedColumnNames="product_operation_id"/>
    </changeSet>

    <changeSet id="pharmacy-drop-unique-name-supplier" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <indexExists indexName="name"/>
        </preConditions>
        <dropUniqueConstraint tableName="pharmacy_product_supplier" constraintName="name"/>
    </changeSet>

    <changeSet id="pharmacy-insert-regimen" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM pharmacy_product_regimen</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (1, 164003, 'af20314c-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (2, 164004, 'af20be49-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (3, 164005, 'af2140ce-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (4, 164006, 'af21cccd-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (5, 164007, 'af225bc4-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (6, 164008, 'af22e423-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (7, 164009, 'af23a935-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (8, 164010, 'af244127-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (9, 164011, 'af2503fa-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (10, 164054, 'af3689c1-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (11, 164055, 'af36a86e-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (12, 164056, 'af36dde9-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (13, 164057, 'af36fea0-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (14, 164058, 'af37212f-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (15, 164059, 'af374265-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (16, 164060, 'af376416-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (17, 164061, 'af3787f2-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (18, 164062, 'af37ab5a-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (19, 164064, 'af38093e-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (20, 164065, 'af382e0c-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (21, 164066, 'af385529-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (22, 164067, 'af387bfc-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (23, 164068, 'af38a264-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (24, 164142, 'af403fe7-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (25, 164143, 'af4053ad-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (26, 164144, 'af40675e-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (27, 164145, 'af407b5e-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (28, 164146, 'af408fdc-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (29, 164407, 'af4b58e7-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (30, 164408, 'af4b74df-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (31, 164409, 'af4b8f7a-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (32, 164410, 'af4baa8b-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (33, 164411, 'af4bc6b4-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (34, 164412, 'af4be2e5-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (35, 164413, 'af4bff64-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (36, 164414, 'af4c1db3-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (37, 164416, 'af4c5b60-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (38, 164417, 'af4c7aae-d85c-11e4-bf10-b9a922ae0303');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (39, 164610, 'c82e1859-901d-4403-bc70-6e0833ac0dd3');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (40, 164611, '5f213de9-6db3-4d27-9520-859b4fe768ff');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (41, 164612, 'f052a9d2-e3f9-4afd-aea3-eae9e9337dbe');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (42, 164664, 'c5f6c1d9-4371-4818-89b9-b752bc5fb79b');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (43, 164663, 'aa35bf1d-0540-44cd-a47f-799449f750e4');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (44, 164662, '069fc0be-e67b-4b64-9325-da04173af056');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (45, 164661, '0a51822a-6d17-47a0-b0b0-b155ca4b80b8');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (46, 164660, '9ec5b832-b53b-4b86-87b2-91a0e6b9a6ba');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (47, 164659, '53cd6414-f3a8-4c65-94f6-77bf0867c15b');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (48, 164658, 'ebbf3480-cbe1-4ecd-8745-49abfb79aca0');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (49, 164657, 'a41b4662-01b8-4b74-8c53-351fa61f4df1');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (50, 164656, 'ccc4e25e-ec6d-4ced-9923-d55bcf7442b2');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (51, 164655, 'c95d5eda-a99b-42b5-b012-7db94114ea71');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (52, 164654, '323bdaca-4a9c-4982-8327-a40f7cc25dad');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (53, 164653, '4962fcbe-d5ee-4ce8-919a-1efb611067e0');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (54, 164652, '7ba2c1a2-6aa9-442a-99fe-93e5b84718f6');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (55, 164651, 'fea4b412-e921-41e1-afc2-224a51f7c635');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (56, 164650, '1c780526-a209-4b22-a5ff-801a5225c0b2');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (57, 164613, 'd2c0165d-5081-4781-ad83-bdc24758e4dc');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (58, 164614, 'f9f0467c-389d-4dfb-9bc0-e8c9fae8963a');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (59, 164615, '21e0e5c1-0670-4179-bedb-7a6c1bac6d0d');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (60, 164616, '1ef8a8c3-7b4b-4db8-a757-2370fd1f0fa3');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (61, 164617, '924d3e5e-0003-41c6-9052-9c9f9a997d68');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (62, 164618, 'f4a4a3a3-9b15-4d69-9460-ac962b0b2d31');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (63, 164619, '5c9dd96d-f376-4992-bbf6-71d3566925b9');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (64, 164620, '7ab1708c-9791-4a22-9582-f077025e5a85');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (65, 164621, 'f075f0e4-81fe-49dc-8279-234e404a6db0');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (66, 164622, '3886ca66-e591-4f51-bf29-aed13baa536a');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (67, 164623, '14eb0e38-c56a-443c-b101-e89cffea44d7');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (68, 164624, '720ab3b1-2bbd-4217-a8c5-1501aa1b0284');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (69, 164625, '5b7c4c9b-7fed-422b-b25e-fc850301ae38');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (70, 164626, 'b9241946-f0c9-4618-b124-59a21d55cb67');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (71, 164627, 'ffc2e56a-a137-4976-b42e-62ad63cb5045');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (72, 164628, 'd7d69675-4780-47d2-b7d1-3c897ddba8d0');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (73, 164629, '632c8bf3-d66a-4c37-aaf6-5d3844ef0809');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (74, 164630, 'b653fbad-89a0-4095-945c-08e02acbe943');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (75, 164631, 'a9a13df5-6ff3-4e70-abe1-05f68beb6989');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (76, 164632, '7e1c2b9b-96a1-435a-be3a-8723f9c7d761');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (77, 164643, 'f731f991-af50-47a5-a506-bbf307691e48');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (78, 164644, 'a3925208-1517-454d-a97c-dc3ad5c7be0a');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (79, 164645, '54e85679-6eae-4ac8-9d12-9a5e8852bc81');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (80, 164646, '563346a7-d02a-48ab-af56-b968842c17a6');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (81, 164647, 'e9c34f67-d946-4014-a64d-1213d4b7a20d');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (82, 164648, 'af7bfd06-9b93-402e-9a41-43db4750599e');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (83, 164649, 'fc2e11b2-b5b8-4afe-a43d-e79822dc432c');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (84, 164633, '6d487c09-db1d-4ba5-80a7-92860ef898cd');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (85, 164634, '61d234c8-23ea-43a3-bdb3-11de989b038c');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (86, 164635, '923941b2-6e37-4c44-ab74-d7d3b27de40f');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (87, 164636, '0c5f4d41-8c85-4759-8655-385837233f10');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (88, 164637, '7f5f9b2a-28b6-4202-80f7-8ea8e7b17559');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (89, 164638, '0f70963d-7ef1-4d00-af76-d58f715b0700');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (90, 164640, 'f2e4ba55-ec58-450d-93f6-a72e5de22803');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (91, 164641, '90a6accb-5eda-4a90-b9b6-95372f15ef9f');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (92, 164642, '14e13b43-f9cb-4a68-9a6e-f92cb60ee46e');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (93, 164639, 'bddd11c3-b9c2-4819-815c-dcefa9125460');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (94, 164679, '66c36dd0-4f23-4eb5-9b32-defdd38025a5');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (95, 164680, 'eb673448-2edb-4ad0-abcd-3fa0c0716f3e');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (96, 165035, '7ed44d78-d800-11e7-b45b-080027e9631b');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (97, 165036, '7ed6ab7c-d800-11e7-b45b-080027e9631b');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (98, 165037, '7ed8ceca-d800-11e7-b45b-080027e9631b');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (99, 165038, '0e3cfac4-2504-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (100, 165039, '0e4206c7-2504-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (101, 165041, '0e46ed95-2504-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (102, 165042, '0e4cc300-2504-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (103, 165043, '0e5141ff-2504-11eb-ae9e-0242ac1a0002');
            INSERT INTO pharmacy_product_regimen (product_regimen_id, concept_id, uuid) VALUES (104, 105281, '105281AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');
        </sql>
    </changeSet>

    <changeSet id="pharmacy-attribute-stock-audit-info" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_product_attribute_stock" columnName="creator"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_product_attribute_stock">
            <column name="creator" type="int" >
                <constraints nullable="false" />
            </column>
            <column name="changed_by" type="int" />
            <column name="date_changed" type="datetime" />
            <column name="voided" type="boolean" defaultValueBoolean="false">
                <constraints nullable="false"/>
            </column>
            <column name="voided_by" type="int" />
            <column name="date_voided" type="datetime" />
            <column name="void_reason" type="varchar(255)" defaultValue="null"/>
        </addColumn>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_stock_creator"
                                 baseTableName="pharmacy_product_attribute_stock" baseColumnNames="creator"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_stock_changed_by"
                                 baseTableName="pharmacy_product_attribute_stock" baseColumnNames="changed_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_attribute_stock_voided_by"
                                 baseTableName="pharmacy_product_attribute_stock" baseColumnNames="voided_by"
                                 referencedTableName="users" referencedColumnNames="user_id"/>
        <addNotNullConstraint tableName="pharmacy_product_attribute_stock" columnName="date_created" columnDataType="datetime"/>
    </changeSet>

    <changeSet id="pharmacy-dispensation-prescription-date-not-null" author="BOGUI SERGE">
        <dropNotNullConstraint tableName="pharmacy_product_dispensation" columnName="prescription_date" columnDataType="date"/>
    </changeSet>

    <changeSet id="pharmacy-mobile-info-treatment-end-date-not-null" author="BOGUI SERGE">
        <dropNotNullConstraint tableName="pharmacy_mobile_patient_dispensation_info" columnName="treatment_end_date" columnDataType="date"/>
    </changeSet>

    <changeSet id="pharmacy-product-transfer-create" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_transfer"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_transfer">
            <column name="product_operation_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="exchange_location" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="transfer_type" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="pharmacy_product_transfer" baseColumnNames="exchange_location"
                                 constraintName="pharmacy_product_transfer_exchange_location"
                                 referencedTableName="location"
                                 referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="location_attribute_is_direct_client" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <sqlCheck expectedResult="1">SELECT COUNT(name) FROM location_attribute_type WHERE name = 'Client Direct NPSP'; </sqlCheck>
            </not>
        </preConditions>
        <insert tableName="location_attribute_type">
            <column name="name" value="Client Direct NPSP"/>
            <column name="datatype" value="org.openmrs.customdatatype.datatype.BooleanDatatype"/>
            <column name="min_occurs" value="0"/>
            <column name="creator" type="int" value="1"/>
            <column name="date_created" type="datetime" value="2021-01-01 21:10:08"/>
            <column name="retired" type="boolean" value="false"/>
            <column name="uuid" value="NPSPCLIENTCCCCCCCCCCCCCCCCCCCCCCCCCC"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO-->
<!--            openmrs.location_attribute_type-->
<!--            (name, datatype, min_occurs, creator, date_created, retired, uuid)-->
<!--            VALUES-->
<!--            ('Client Direct NPSP', 'org.openmrs.customdatatype.datatype.BooleanDatatype', 0, 1, '2020-12-15 21:10:08', 0, 'NPSPCLIENTCCCCCCCCCCCCCCCCCCCCCCCCCC');-->

<!--        </sql>-->
    </changeSet>

    <changeSet id="pharmacy-movement_out-remove-recipient-index-not-null" author="BOGUI SERGE">
        <dropNotNullConstraint tableName="pharmacy_product_movement_out" columnName="recipient" columnDataType="int"/>
    </changeSet>

    <changeSet id="pharmacy-product-report" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_report"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_report">
            <column name="product_operation_id" type="int">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="report_type" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="report_period" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="report_info" type="longtext"/>
            <column name="report_location_id" type="int">
                <constraints nullable="false"/>
            </column>
            <column name="is_urgent" type="boolean"/>
            <column name="report_treatment_date" type="date"/>
            <column name="child_location_report_id" type="int"/>

        </createTable>
        <addForeignKeyConstraint constraintName="pharmacy_product_report_product_operation"
                                 baseTableName="pharmacy_product_report" baseColumnNames="product_operation_id"
                                 referencedTableName="pharmacy_product_operation" referencedColumnNames="product_operation_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_report_location"
                                 baseTableName="pharmacy_product_report" baseColumnNames="report_location_id"
                                 referencedTableName="location" referencedColumnNames="location_id"/>
        <addForeignKeyConstraint constraintName="pharmacy_product_report_child_report"
                                 baseTableName="pharmacy_product_report" baseColumnNames="child_location_report_id"
                                 referencedTableName="pharmacy_product_report" referencedColumnNames="product_operation_id"/>
    </changeSet>

    <changeSet id="pharmacy-product-back-supplier-create" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="pharmacy_product_back_supplier"/>
            </not>
        </preConditions>
        <createTable tableName="pharmacy_product_back_supplier">
            <column name="product_operation_id" type="int">
                <constraints primaryKey="true"/>
            </column>
            <column name="exchange_location" type="int">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="pharmacy_product_back_supplier" baseColumnNames="exchange_location"
                                 constraintName="pharmacy_product_back_supplier_exchange_location"
                                 referencedTableName="location"
                                 referencedColumnNames="location_id"/>
    </changeSet>

    <changeSet id="location_attribute_program_available" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <sqlCheck expectedResult="1">SELECT COUNT(name) FROM location_attribute_type WHERE name = 'Programmes Disponibles'; </sqlCheck>
            </not>
        </preConditions>
        <insert tableName="location_attribute_type">
            <column name="name" value="Programmes Disponibles"/>
            <column name="datatype" value="org.openmrs.customdatatype.datatype.FreeTextDatatype"/>
            <column name="min_occurs" value="0"/>
            <column name="creator" type="int" value="1"/>
            <column name="date_created" type="datetime" value="2021-01-01 21:10:08"/>
            <column name="retired" type="boolean" value="false"/>
            <column name="uuid" value="AVAILPRGRMCCCCCCCCCCCCCCCCCCCCCCCCCC"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO-->
<!--            location_attribute_type-->
<!--            (name, datatype, min_occurs, creator, date_created, retired, uuid)-->
<!--            VALUES-->
<!--            ('', 'org.openmrs.customdatatype.datatype.FreeTextDatatype', 0, 1, '2021-01-01 21:10:08', 0, 'AVAILPRGRMCCCCCCCCCCCCCCCCCCCCCCCCCC');-->
<!--        </sql>-->
    </changeSet>

    <changeSet id="location_attribute_level" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <sqlCheck expectedResult="1">SELECT COUNT(name) FROM location_attribute_type WHERE name = 'Niveau'; </sqlCheck>
            </not>
        </preConditions>
        <insert tableName="location_attribute_type">
            <column name="name" value="Niveau"/>
            <column name="datatype" value="org.openmrs.customdatatype.datatype.FreeTextDatatype"/>
            <column name="min_occurs" value="0"/>
            <column name="creator" type="int" value="1"/>
            <column name="date_created" type="datetime" value="2021-01-01 21:10:08"/>
            <column name="retired" type="boolean" value="false"/>
            <column name="uuid" value="LEVELCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO-->
<!--            location_attribute_type-->
<!--            (name, datatype, min_occurs, creator, date_created, retired, uuid)-->
<!--            VALUES-->
<!--            ('Niveau', 'org.openmrs.customdatatype.datatype.FreeTextDatatype', 0, 1, '2021-01-01 21:10:08', 0, '');-->
<!--        </sql>-->
    </changeSet>

    <changeSet id="location_attribute_npsp_code" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <sqlCheck expectedResult="1">SELECT COUNT(name) FROM location_attribute_type WHERE name = 'CODE NPSP'; </sqlCheck>
            </not>
        </preConditions>
        <insert tableName="location_attribute_type">
            <column name="name" value="CODE NPSP"/>
            <column name="datatype" value="org.openmrs.customdatatype.datatype.FreeTextDatatype"/>
            <column name="min_occurs" value="0"/>
            <column name="creator" type="int" value="1"/>
            <column name="date_created" type="datetime" value="2021-02-06 13:00:00"/>
            <column name="retired" type="boolean" value="false"/>
            <column name="uuid" value="CODENPSPCCCCCCCCCCCCCCCCCCCCCCCCCCCC"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO-->
<!--            location_attribute_type-->
<!--            (name, datatype, min_occurs, creator, date_created, retired, uuid)-->
<!--            VALUES-->
<!--            ('CODE NPSP', 'org.openmrs.customdatatype.datatype.FreeTextDatatype', 0, 1, '2021-02-06 13:00:00', 0, 'CODENPSPCCCCCCCCCCCCCCCCCCCCCCCCCCCC');-->
<!--        </sql>-->
    </changeSet>

    <changeSet id="pharmacy-create-role-auxiliary-2" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM role WHERE role = 'AUXILIAIRE'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO role (role, description, uuid) VALUES ('AUXILIAIRE', 'Auxiliaire de la pharmacie', 'AUXILIAIRERRRRRRRRRRRRRRRRRRRRRRRRRR');
        </sql>
    </changeSet>
    <changeSet id="pharmacy-add-privilege-auxiliary-0" author="BOGUI SERGE" runOnChange="true" dbms="mysql">
        <preConditions onFail="CONTINUE" onError="CONTINUE">
            <and>
                <not>
                    <sqlCheck expectedResult="45">
                        SELECT COUNT(*) FROM role_privilege WHERE role = 'AUXILIAIRE'
                    </sqlCheck>
                </not>
                <sqlCheck expectedResult="1">SELECT COUNT(*) FROM privilege WHERE privilege = 'View Dispensation'</sqlCheck>
            </and>
        </preConditions>
        <sql>
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Add Report Objects');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Add Reports');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Delete Report Objects');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Delete Reports');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Edit Report Objects');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Edit Reports');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Manage Global Properties');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Run Reports');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Concepts');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Locations');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Navigation Menu');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Patients');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Report Objects');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Reports');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Roles');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Synchronization Records');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Synchronization Status');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Users');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Dispensation');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Exchange Entity');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Inventory');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Movement');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Patient Programs');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Product Attribute');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Program');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Reception');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Regimen');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Stock');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Unit');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Delete Dispensation');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Delete Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Save Dispensation');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Save Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Add Encounters');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Delete Encounters');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Encounter Roles');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Encounters');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'View Encounter Types');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Transform Dispensation');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Manage Pharmacy');
            INSERT INTO role_privilege (role, privilege) VALUES ('AUXILIAIRE', 'Manage Stock');
        </sql>
    </changeSet>
    <changeSet id="pharmacy-create-role-pgp" author="BOGUI SERGE">
        <preConditions onFail="CONTINUE">
            <sqlCheck expectedResult="0">SELECT COUNT(role) FROM role WHERE role = 'PGP'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO role (role, description, uuid) VALUES ('PGP', 'Pharmacien de la pharmacie', 'PGPRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR');
        </sql>
    </changeSet>
    <changeSet id="pharmacy_create-add-pgp-privileges-0" author="BOGUI SERGE" runOnChange="true">
        <preConditions onFail="CONTINUE" onError="CONTINUE">
            <and>
                <not>
                    <sqlCheck expectedResult="16">SELECT COUNT(*) FROM role_privilege WHERE role = 'PGP'</sqlCheck>
                </not>
<!--                <sqlCheck expectedResult="1">SELECT COUNT(*) FROM privilege WHERE privilege = 'View Edit Product Back Supplier'</sqlCheck>-->
                <sqlCheck expectedResult="1">SELECT COUNT(*) FROM privilege WHERE privilege = 'View Product Back Supplier'</sqlCheck>
                <sqlCheck expectedResult="1">SELECT COUNT(*) FROM privilege WHERE privilege = 'Save Product Back Supplier'</sqlCheck>
            </and>
        </preConditions>
        <sql>
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'View Product Back Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'View Transfer');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Inventory');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Movement');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Product Attribute');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Product Back Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Transfer');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Delete Reception');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Product Back Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Inventory');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Movement');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Transfer');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Product Attribute');
            INSERT INTO role_privilege (role, privilege) VALUES ('PGP', 'Save Reception');
        </sql>
    </changeSet>
    <changeSet id="pharmacy-create-role-pharmacist-1" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM role WHERE role = 'PHARMACIEN'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO role (role, description, uuid) VALUES ('PHARMACIEN', 'Pharmacien de la pharmacie', 'PHARMACIENRRRRRRRRRRRRRRRRRRRRRRRRRR');
        </sql>
    </changeSet>

    <changeSet id="pharmacy-add-pharmacist-privileges-0" author="BOGUI SERGE" runOnChange="true">
        <preConditions onFail="CONTINUE" onError="CONTINUE">
            <and>
                <not>
                    <sqlCheck expectedResult="44">SELECT COUNT(*) FROM role_privilege WHERE role = 'PHARMACIEN'
                    </sqlCheck>
                </not>
                <sqlCheck expectedResult="1">SELECT COUNT(*) FROM privilege WHERE privilege = 'Manage Dispensation'</sqlCheck>
            </and>
        </preConditions>
        <sql>
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Dispensation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Exchange Entity');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Inventory');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Movement');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Product Attribute');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Product Back Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Program');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Programs');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Reception');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Regimen');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Stock');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Transfer');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Manage Unit');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Dispensation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Inventory');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Movement');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Product Back Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Reception');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Validate Transfer');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Exchange Entity');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Program');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Regimen');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Unit');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Delete Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Delete Program');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Delete Supplier');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Delete Unit');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Import Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Import Regimen');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Delete Exchange Entity');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'View Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Save Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Delete Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Import Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Submit Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN', 'Treat Report');
        </sql>
    </changeSet>

    <changeSet id="pharmacy-create-role-pgp-auxiliary" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM role_role WHERE parent_role = 'AUXILIAIRE' AND child_role = 'PGP'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO role_role (parent_role, child_role) VALUES ('AUXILIAIRE', 'PGP');
        </sql>
    </changeSet>

    <changeSet id="pharmacy-create-role-pgp-pharmacist" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(*) FROM role_role WHERE parent_role = 'PGP' AND child_role = 'PHARMACIEN'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO role_role (parent_role, child_role) VALUES ('PGP', 'PHARMACIEN');
        </sql>
    </changeSet>

    <changeSet id="pharmacy-product-report-report-location-null-index" author="BOGUI SERGE">
        <dropNotNullConstraint tableName="pharmacy_product_report" columnName="report_location_id" columnDataType="int"/>
    </changeSet>

    <changeSet id="pharmacy-attribute-other-flux-integer-double-1" author="BOGUI SERGE">
        <modifyDataType tableName="pharmacy_product_attribute_other_flux" columnName="quantity" newDataType="float"/>
<!--        <sql>-->
<!--            alter table pharmacy_product_attribute_other_flux modify quantity float(11,1) not null;-->
<!--        </sql>-->
    </changeSet>

    <changeSet id="pharmacy-create-direct-clients-2" author="BOGUI SERGE" runAlways="true" dbms="mysql">
        <sql>
            INSERT INTO location_attribute (location_attribute_id, location_id, attribute_type_id, value_reference, uuid, creator, date_created, voided)
            SELECT NULL AS location_attribute_id, location_id, (SELECT location_attribute_type_id FROM location_attribute_type WHERE uuid = 'NPSPCLIENTCCCCCCCCCCCCCCCCCCCCCCCCCC' ) attribute_type_id, 'true' AS value_reference, uuid() AS uuid, 1, '2021-01-01 00:00:00', 0
            FROM location l
            WHERE
            (name LIKE 'CHU %' OR name LIKE 'CHR %' OR name LIKE 'HG %' OR name LIKE 'DISTRICT SANITAIRE %')
            AND location_id NOT IN (SELECT location_id FROM location_attribute la WHERE attribute_type_id = (SELECT location_attribute_type_id FROM location_attribute_type lat WHERE uuid = 'NPSPCLIENTCCCCCCCCCCCCCCCCCCCCCCCCCC' ) AND la.location_id = l.location_id)
        </sql>
    </changeSet>

    <changeSet id="pharmacy-create-direct-clients-3" author="BOGUI SERGE" runAlways="true" dbms="postgresql">
        <sql>
            INSERT INTO location_attribute (location_id, attribute_type_id, value_reference, uuid, creator, date_created, voided)
            SELECT location_id, (SELECT location_attribute_type_id FROM location_attribute_type WHERE uuid = 'NPSPCLIENTCCCCCCCCCCCCCCCCCCCCCCCCCC' ) attribute_type_id, 'true' AS value_reference, uuid() AS uuid, 1, '2021-01-01 00:00:00', true
            FROM location l
            WHERE
            (name LIKE 'CHU %' OR name LIKE 'CHR %' OR name LIKE 'HG %' OR name LIKE 'DISTRICT SANITAIRE %')
            AND location_id NOT IN (SELECT location_id FROM location_attribute la WHERE attribute_type_id = (SELECT location_attribute_type_id FROM location_attribute_type lat WHERE uuid = 'NPSPCLIENTCCCCCCCCCCCCCCCCCCCCCCCCCC' ) AND la.location_id = l.location_id)
        </sql>
    </changeSet>

    <changeSet id="pharmacy-product-movement-entry-sender-null-index" author="BOGUI SERGE">
        <dropNotNullConstraint tableName="pharmacy_product_movement_entry" columnName="sender" columnDataType="int"/>
    </changeSet>

    <changeSet id="pharmacy-product-movement-out-recipient-null-index" author="BOGUI SERGE">
        <dropNotNullConstraint tableName="pharmacy_product_movement_out" columnName="recipient" columnDataType="int"/>
    </changeSet>

    <changeSet id="pharmacy-create-role-pharmacist-anonymous" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(role) FROM role WHERE role = 'PHARMACIEN ANONYME'</sqlCheck>
        </preConditions>
        <sql>
            INSERT INTO role (role, description, uuid) VALUES ('PHARMACIEN ANONYME', 'Pharmacien non utilisateur de SIGDEP', 'PHARMACIENANONYMERRRRRRRRRRRRRRRRRRR');
        </sql>
    </changeSet>

    <changeSet id="pharmacy-add-pharmacist-anonymous-privileges-0" author="BOGUI SERGE" runOnChange="true">
        <preConditions onFail="CONTINUE" onError="CONTINUE">
            <and>
                <not>
                    <sqlCheck expectedResult="25">SELECT COUNT(*) FROM role_privilege WHERE role = 'PHARMACIEN ANONYME'
                    </sqlCheck>
                </not>
                <sqlCheck expectedResult="1">SELECT COUNT(*) FROM privilege WHERE privilege = 'Save Report'</sqlCheck>
            </and>
        </preConditions>
        <sql>
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Pharmacy');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Product Attribute');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Program');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Stock');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Manage Unit');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Locations');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Navigation Menu');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Users');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Save Flux');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Operation');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Inventory');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Product');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Product Attribute');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Program');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Stock');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Unit');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'View Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Save Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Delete Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Import Report');
            INSERT INTO role_privilege (role, privilege) VALUES ('PHARMACIEN ANONYME', 'Submit Report');
        </sql>
    </changeSet>
<!--    <changeSet id="pharmacy-reset-data-procedure" author="BOGUI SERGE" runOnChange="true">-->
<!--        <createProcedure>-->
<!--            <![CDATA[-->
<!--            CREATE OR REPLACE PROCEDURE reset_pharmacy_data-->
<!--            IS-->
<!--            BEGIN-->
<!--                SET FOREIGN_KEY_CHECKS = 0;-->
<!--                truncate table pharmacy_mobile_patient_dispensation_info;-->
<!--                truncate table pharmacy_mobile_patient_product_dispensing_members;-->
<!--                truncate table pharmacy_mobile_patient;-->
<!--                truncate table pharmacy_product_attribute_flux;-->
<!--                truncate table pharmacy_product_attribute_other_flux;-->
<!--                truncate table pharmacy_product_attribute_stock;-->
<!--                truncate table pharmacy_product_attribute;-->
<!--                truncate table pharmacy_product_back_supplier;-->
<!--                truncate table pharmacy_product_dispensation;-->
<!--                truncate table pharmacy_product_inventory;-->
<!--                truncate table pharmacy_product_movement_entry;-->
<!--                truncate table pharmacy_product_movement_out;-->
<!--                truncate table pharmacy_product_report;-->
<!--                truncate table pharmacy_product_operation;-->
<!--                truncate table pharmacy_product_transfer;-->
<!--                TRUNCATE table pharmacy_product_reception;-->
<!--                SET FOREIGN_KEY_CHECKS = 1;-->
<!--            END;-->
<!--            ]]>-->
<!--        </createProcedure>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-drop-mobile-dispensing-members" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <tableExists tableName="pharmacy_mobile_patient_product_dispensing_members"/>
        </preConditions>
        <dropTable tableName="pharmacy_mobile_patient_product_dispensing_members"/>
    </changeSet>

    <changeSet id="pharmacy-mobile-dispensation-info-add-column" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_mobile_patient_dispensation_info" columnName="patient_id"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_mobile_patient_dispensation_info">
            <column name="patient_id" type="int"/>
        </addColumn>
        <addForeignKeyConstraint baseTableName="pharmacy_mobile_patient_dispensation_info" baseColumnNames="patient_id"
                                 constraintName="pharmacy_mobile_patient_dispensation_info_patient_patient"
                                 referencedTableName="patient"
                                 referencedColumnNames="patient_id"/>
    </changeSet>

<!--    <changeSet id="pharmacy-add-program-number-program" author="BOGUI SERGE">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <not>-->
<!--                <columnExists tableName="pharmacy_product_program" columnName="program_number"/>-->
<!--            </not>-->
<!--        </preConditions>-->
<!--        <addColumn tableName="pharmacy_product_program">-->
<!--            <column name="program_number" type="int">-->
<!--                <constraints nullable="false"/>-->
<!--            </column>-->
<!--        </addColumn>-->
<!--        <sql>-->
<!--            UPDATE pharmacy_product_program SET program_number = 0 WHERE name = 'PNLSARVIO';-->
<!--            UPDATE pharmacy_product_program SET program_number = 1 WHERE name = 'PNLSLAB';-->
<!--            UPDATE pharmacy_product_program SET program_number = 2 WHERE name = 'ME_REC';-->
<!--            UPDATE pharmacy_product_program SET program_number = 3 WHERE name = 'GTC';-->
<!--            UPDATE pharmacy_product_program SET program_number = 4 WHERE name = 'PNSME';-->
<!--            UPDATE pharmacy_product_program SET program_number = 5 WHERE name = 'PNLT';-->
<!--            UPDATE pharmacy_product_program SET program_number = 6 WHERE name = 'PNLP';-->
<!--            UPDATE pharmacy_product_program SET program_number = 7 WHERE name = 'CONSO';-->
<!--            UPDATE pharmacy_product_program SET program_number = 8 WHERE name = 'PNLSTRC';-->
<!--            UPDATE pharmacy_product_program SET program_number = 9 WHERE name = 'PNLS_CHARGE VIRALE';-->
<!--        </sql>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-provider-attribute-location" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <sqlCheck expectedResult="1">SELECT COUNT(name) FROM provider_attribute_type WHERE name = 'Location'; </sqlCheck>
            </not>
        </preConditions>
        <insert tableName="provider_attribute_type">
            <column name="name" value="Location"/>
            <column name="datatype" value="org.openmrs.customdatatype.datatype.FreeTextDatatype"/>
            <column name="min_occurs" value="0"/>
            <column name="creator" type="int" value="1"/>
            <column name="date_created" type="datetime" value="2021-02-27 21:10:08"/>
            <column name="retired" type="boolean" value="false"/>
            <column name="uuid" value="LOCATIONPPPPPPPPPPPPPPPPPPPPPPPPPPPP"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO-->
<!--            provider_attribute_type-->
<!--            (name, datatype, min_occurs, creator, date_created, retired, uuid)-->
<!--            VALUES-->
<!--            ('Location', 'org.openmrs.customdatatype.datatype.FreeTextDatatype', 0, 1, '2021-02-27 21:10:08', 0, 'LOCATIONPPPPPPPPPPPPPPPPPPPPPPPPPPPP');-->
<!--        </sql>-->
    </changeSet>
<!--    <changeSet id="pharmacy-update-file-active-listing" author="BOGUI SERGE">-->
<!--        <preConditions>-->
<!--            <sqlCheck expectedResult="0">-->
<!--                <![CDATA[-->
<!--                    SELECT COUNT(*) FROM serialized_object WHERE uuid = '338d665c-4486-471c-a62a-ddb1a1307a10' AND date_changed <= '2021-06-27 16:48:23'-->
<!--                ]]>-->
<!--            </sqlCheck>-->
<!--        </preConditions>-->
<!--        <sqlFile path="UPDATE.sql"/>-->
<!--    </changeSet>-->
    <changeSet id="pharmacy-dispensation-add-column-regimen-line" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_mobile_patient_dispensation_info" columnName="regimen_line"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_mobile_patient_dispensation_info">
            <column name="regimen_line" type="int"/>
        </addColumn>
    </changeSet>

<!--    <changeSet id="pharmacy-update-encounter-type-dispensation" author="BOGUI SERGE" runOnChange="true">-->
<!--        <preConditions onFail="CONTINUE">-->
<!--            <sqlCheck expectedResult="1">-->
<!--                <![CDATA[-->
<!--                SELECT COUNT(*) FROM encounter_type WHERE name = 'DISPENSATION' AND encounter_type_id = 17;-->
<!--                ]]>-->
<!--            </sqlCheck>-->
<!--        </preConditions>-->
<!--        <sql>-->
<!--            <![CDATA[-->
<!--            UPDATE encounter SET encounter_type = (SELECT encounter_type_id FROM encounter_type WHERE name = 'DISPENSATION')-->
<!--            WHERE encounter_type = 17;-->
<!--            ]]>-->
<!--        </sql>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-add-column-operation-id-to-stock" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <not>
                <columnExists tableName="pharmacy_product_attribute_stock" columnName="operation_id"/>
            </not>
        </preConditions>
        <addColumn tableName="pharmacy_product_attribute_stock">
            <column name="operation_id" type="int"/>
        </addColumn>
        <addForeignKeyConstraint baseTableName="pharmacy_product_attribute_stock" baseColumnNames="operation_id"
                                 constraintName="pharmacy_product_attribute_stock_operation"
                                 referencedTableName="pharmacy_product_operation"
                                 referencedColumnNames="product_operation_id"/>
    </changeSet>

    <changeSet id="pharmacy-add-TDF-3TC-concept-to-regimen-list-1" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">
                SELECT COUNT(*) FROM pharmacy_product_regimen WHERE concept_id = 161364;
            </sqlCheck>
        </preConditions>
        <sql>
            <![CDATA[
            INSERT INTO pharmacy_product_regimen (concept_id, uuid)
            VALUES (161364, '161364AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');
            ]]>
        </sql>
    </changeSet>

    <changeSet id="pharmacy-update-TDF-3TC-concept-name" author="BOGUI SERGE">
        <sql>
            <![CDATA[
            UPDATE concept_name
            SET name = 'TDF 3TC'
            WHERE concept_name_id = 99248;
            ]]>
        </sql>
    </changeSet>

<!--    <changeSet id="pharmacy-change-product-supplier-to-location" author="BOGUI SEBE">-->
<!--        <dropForeignKeyConstraint constraintName="pharmacy_product_reception_product_supplier" baseTableName="pharmacy_product_reception"/>-->
<!--    </changeSet>-->

<!--    <changeSet id="pharmacy-add-NPSP-to-location-list" author="BOGUI SERGE" runAlways="true">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <sqlCheck expectedResult="0">-->
<!--                SELECT COUNT(*) FROM location WHERE uuid = 'NPSPCIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA';-->
<!--            </sqlCheck>-->
<!--        </preConditions>-->
<!--        <sql>-->
<!--            <![CDATA[-->
<!--            INSERT INTO location (name, description, address1, address2, city_village, state_province, postal_code, country,-->
<!--                              latitude, longitude, creator, date_created, county_district, address3, address4, address5,-->
<!--                              address6, retired, retired_by, date_retired, retire_reason, parent_location, uuid,-->
<!--                              changed_by, date_changed)-->
<!--            VALUES ('NOUVELLE PHARMACIE DE COTE D''IVOIRE', 'NOUVELLE PHARMACIE DE COTE D''IVOIRE', null, null, null, null, null, null, null, null, 1,-->
<!--            '2021-08-01 22:16:54', null, null, null, null, null, 0, null, null, null, 1,-->
<!--            'NPSPCIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA', null, null);-->

<!--            UPDATE pharmacy_product_reception SET product_supplier_id = (SELECT location_id FROM location WHERE uuid = 'NPSPCIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA')-->
<!--            WHERE location_id IS NOT NULL;-->
<!--            ]]>-->
<!--        </sql>-->
<!--    </changeSet>-->

    <changeSet id="pharmacy-add-goal_new-concept" author="BOGUI SERGE">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(concept_id) FROM concept WHERE concept_id = 163000</sqlCheck>
        </preConditions>
        <insert tableName="concept">
            <column name="concept_id" value="163000"/>
            <column name="retired" type="boolean" value="false"/>
            <column name="datatype_id" type="int" value="3"/>
            <column name="class_id" type="int" value="7"/>
            <column name="is_set" type="boolean" value="false"/>
            <column name="creator" type="int" value="1"/>
            <column name="date_created" type="datetime" value="2020-11-27 00:00:00"/>
            <column name="uuid" value="163000AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
        </insert>
        <insert tableName="concept_name">
            <column name="concept_id" type="int" value="163000"/>
            <column name="name" value="Goal"/>
            <column name="date_created" type="datetime" value="2020-11-27 00:00:00"/>
            <column name="concept_name_type" value="FULLY_SPECIFIED"/>
            <column name="creator" type="int" value="1"/>
            <column name="locale" value="fr"/>
            <column name="locale_preferred" type="boolean" value="true"/>
            <column name="voided" type="boolean" value="false"/>
            <column name="uuid" value="163000AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
        </insert>
<!--        <sql>-->
<!--            INSERT INTO concept (concept_id, retired, datatype_id, class_id, is_set, creator, date_created, uuid)-->
<!--            VALUES (163000, 0, 3, 7, 0, 1, '2020-11-27 00:00:00', '163000AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');-->

<!--            INSERT INTO concept_name (concept_id, name, date_created, concept_name_type, creator, locale, locale_preferred, voided, uuid)-->
<!--            VALUES (163000, 'Goal', '2020-11-27 00:00:00', 'FULLY_SPECIFIED', 1, 'fr', 1, 0, '163000AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');-->
<!--        </sql>-->
    </changeSet>

<!--    <changeSet id="pharmacy-change-goal-concept-global-property" author="BOGUI SERGE">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <sqlCheck expectedResult="0">-->
<!--                SELECT COUNT(*) FROM global_property WHERE property LIKE 'pharmacy.dispensationGoalConcept' ESCAPE '#'-->
<!--                AND property_value = '163000';-->
<!--            </sqlCheck>-->
<!--        </preConditions>-->
<!--        <sql>-->
<!--            <![CDATA[-->
<!--            UPDATE global_property t-->
<!--            SET t.property_value = '163000'-->
<!--            WHERE t.property LIKE 'pharmacy.dispensationGoalConcept' ESCAPE '#';-->
<!--            ]]>-->
<!--        </sql>-->
<!--    </changeSet>-->

<!--    <changeSet id="pharmacy-update-dispensation-goal-165009-to-163000" author="BOGUI SERGE">-->
<!--        <preConditions onFail="MARK_RAN">-->
<!--            <not>-->
<!--                <sqlCheck expectedResult="0">-->
<!--                    SELECT COUNT(*) FROM obs o, encounter e, encounter_type et-->
<!--                    WHERE o.encounter_id = e.encounter_id AND et.encounter_type_id = e.encounter_type-->
<!--                    AND et.uuid = 'cfb217pd-4af2-40f4-9d6e-0d1b38d2af86' AND o.concept_id = 165009;-->
<!--                </sqlCheck>-->
<!--            </not>-->
<!--        </preConditions>-->
<!--        <sql>-->
<!--            <![CDATA[-->
<!--            UPDATE obs o-->
<!--            INNER JOIN encounter e ON o.encounter_id = e.encounter_id-->
<!--            INNER JOIN encounter_type et ON et.encounter_type_id = e.encounter_type-->
<!--            SET o.concept_id = 163000-->
<!--            WHERE et.uuid = 'cfb217pd-4af2-40f4-9d6e-0d1b38d2af86' AND o.concept_id = 165009-->
<!--            ]]>-->
<!--        </sql>-->
<!--    </changeSet>-->

<!--    <changeSet id="pharmacy-add-default-location-property" author="BOGUI SERGE">-->
<!--        <sql>-->
<!--            <![CDATA[-->
<!--            INSERT INTO user_property (user_id, property, property_value)-->
<!--            SELECT user_id, 'defaultLocation' AS property, '' AS property_value FROM users-->
<!--            WHERE user_id NOT IN (SELECT user_id FROM user_property WHERE property = 'defaultLocation');-->
<!--            ]]>-->
<!--        </sql>-->
<!--    </changeSet>-->

</databaseChangeLog>
